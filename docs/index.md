
---

# Пользовательское API

Это веб-API предоставляет ряд эндпоинтов для работы с пользователями(api.py).

## Регистрация нового пользователя

### `POST /register/`

Регистрирует нового пользователя и добавляет его в базу данных.

**Параметры запроса:**
- `user`: Объект, описывающий нового пользователя. Должен содержать следующие поля:
  - `email`: Электронная почта нового пользователя.
  - `password`: Пароль нового пользователя.

**Пример запроса:**
```json
{
  "user": {
    "email": "example@example.com",
    "password": "examplepassword"
  }
}
```

## Аутентификация пользователя

### `POST /login/`

Аутентифицирует пользователя и генерирует JWT-токен для дальнейшего доступа к API.

**Параметры запроса:**
- `user_credentials`: Объект, содержащий учетные данные пользователя. Должен содержать следующие поля:
  - `email`: Электронная почта пользователя.
  - `password`: Пароль пользователя.

**Пример запроса:**
```json
{
  "email": "example@example.com",
  "password": "examplepassword"
}
```

## Получение информации о текущем пользователе

### `GET /user/`

Получает информацию о текущем аутентифицированном пользователе.

**Требуемые заголовки:**
- `Authorization`: JWT-токен, полученный при аутентификации пользователя.

## Получение списка пользователей

### `GET /users/`

Получает список пользователей из базы данных.

**Параметры запроса:**
- `skip` (необязательный): Целое число, определяющее количество пропускаемых пользователей.
- `limit` (необязательный): Целое число, определяющее максимальное количество пользователей, которые следует вернуть.

**Пример запроса:**
```
/users/?skip=0&limit=10
```

## Изменение пароля текущего пользователя

### `PUT /user/change-password/`

Изменяет пароль текущего пользователя.

**Требуемые заголовки:**
- `Authorization`: JWT-токен, полученный при аутентификации пользователя.

**Параметры запроса:**
- `new_password`: Объект, содержащий новый пароль пользователя. Должен содержать следующие поля:
  - `password`: Новый пароль пользователя.

**Пример запроса:**
```json
{
  "password": "newpassword"
}
```

---


---

# Вспомогательные функции работы с пользователями

Эти функции предназначены для работы с пользователями в базе данных и для аутентификации.

## Получение пользователя по ID

### `def get_user(db: Session, user_id: int) -> models.User`

Получает пользователя из базы данных по его уникальному идентификатору.

**Параметры:**
- `db`: Сессия базы данных SQLAlchemy.
- `user_id`: Уникальный идентификатор пользователя.

## Получение пользователя по адресу электронной почты

### `def get_user_by_email(db: Session, email: str) -> models.User`

Получает пользователя из базы данных по его адресу электронной почты.

**Параметры:**
- `db`: Сессия базы данных SQLAlchemy.
- `email`: Адрес электронной почты пользователя.

## Аутентификация пользователя

### `def authenticate_user(db: Session, email: str, password: str) -> Union[models.User, bool]`

Аутентифицирует пользователя по его адресу электронной почты и паролю.

**Параметры:**
- `db`: Сессия базы данных SQLAlchemy.
- `email`: Адрес электронной почты пользователя.
- `password`: Пароль пользователя.

## Создание нового пользователя

### `def create_user(db: Session, user: schemas.UserCreate) -> models.User`

Создает нового пользователя и добавляет его в базу данных.

**Параметры:**
- `db`: Сессия базы данных SQLAlchemy.
- `user`: Объект, описывающий нового пользователя. Должен содержать следующие поля:
  - `email`: Электронная почта нового пользователя.
  - `password`: Пароль нового пользователя.

## Проверка пароля

### `def verify_password(plain_password: str, hashed_password: str) -> bool`

Проверяет, совпадает ли предоставленный пароль с хэшированным паролем пользователя.

**Параметры:**
- `plain_password`: Пароль в текстовом формате, который нужно проверить.
- `hashed_password`: Хэшированный пароль, с которым нужно сравнить предоставленный пароль.

---

Для функций, отвечающих за подключение к базе данных и инициализацию сессии SQLAlchemy:

---

# Подключение к базе данных

Эти функции обеспечивают подключение к базе данных и инициализацию сессии SQLAlchemy для работы с ней.

## Инициализация базы данных

### `def init_db() -> None`

Инициализирует базу данных, создавая все необходимые таблицы на основе определений моделей.

## Получение сессии SQLAlchemy

### `def get_session() -> Session`

Возвращает сессию SQLAlchemy для работы с базой данных. Эта сессия автоматически закрывается после использования.

---


API для управления пользователями
Это веб-API предоставляет возможности для регистрации пользователей, аутентификации, управления пользователями и смены пароля.

Эндпоинты
Регистрация нового пользователя
Метод: POST
Путь: /register/
Описание: Регистрирует нового пользователя с предоставленными учетными данными.
Аутентификация пользователя
Метод: POST
Путь: /login/
Описание: Аутентифицирует пользователя по предоставленным учетным данным и генерирует JWT-токен для доступа.
Получение информации о текущем пользователе
Метод: GET
Путь: /user/
Описание: Возвращает информацию о текущем аутентифицированном пользователе.
Получение списка пользователей
Метод: GET
Путь: /users/
Описание: Возвращает список пользователей с возможностью пагинации.
Смена пароля текущего пользователя
Метод: PUT
Путь: /user/change-password/
Описание: Позволяет текущему пользователю изменить свой пароль.
Запуск приложения
Для инициализации базы данных при запуске приложения используется событие startup.